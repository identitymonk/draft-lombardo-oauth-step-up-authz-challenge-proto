{
  "magic": "E!vIA5L86J2I",
  "timestamp": "2025-06-24T01:41:18.808639+00:00",
  "repo": "identitymonk/draft-lombardo-oauth-step-up-authz-challenge-proto",
  "labels": [
    {
      "name": "bug",
      "description": "Something isn't working",
      "color": "d73a4a"
    },
    {
      "name": "documentation",
      "description": "Improvements or additions to documentation",
      "color": "0075ca"
    },
    {
      "name": "duplicate",
      "description": "This issue or pull request already exists",
      "color": "cfd3d7"
    },
    {
      "name": "enhancement",
      "description": "New feature or request",
      "color": "a2eeef"
    },
    {
      "name": "good first issue",
      "description": "Good for newcomers",
      "color": "7057ff"
    },
    {
      "name": "help wanted",
      "description": "Extra attention is needed",
      "color": "008672"
    },
    {
      "name": "invalid",
      "description": "This doesn't seem right",
      "color": "e4e669"
    },
    {
      "name": "question",
      "description": "Further information is requested",
      "color": "d876e3"
    },
    {
      "name": "wontfix",
      "description": "This will not be worked on",
      "color": "ffffff"
    }
  ],
  "issues": [
    {
      "number": 2,
      "id": "I_kwDOOIDCrM64Q37e",
      "title": "Security considerations",
      "url": "https://github.com/identitymonk/draft-lombardo-oauth-step-up-authz-challenge-proto/issues/2",
      "state": "OPEN",
      "author": "gffletch",
      "authorAssociation": "NONE",
      "assignees": [],
      "labels": [],
      "body": "I'd recommend pulling out each point of the security considerations into it's own sub-section. This will make it clearer to the reader.\n\nAlso, the point that the enterprise is \"leaking\" authorization policy into the response to the client is something that I think should be more clearly stated. Or maybe call out that if this is a concern plan to use the \"PAR\" extension. ",
      "createdAt": "2025-05-26T14:44:08Z",
      "updatedAt": "2025-06-23T21:12:05Z",
      "closedAt": null,
      "comments": [
        {
          "author": "identitymonk",
          "authorAssociation": "OWNER",
          "body": "Right on @gffletch , I thought about the same thing about PAR.\n\nBut a PAR starting at the RP would even better. Might worth discussing as a separate proposal maybe?",
          "createdAt": "2025-05-28T02:00:26Z",
          "updatedAt": "2025-05-28T02:00:26Z"
        },
        {
          "author": "identitymonk",
          "authorAssociation": "OWNER",
          "body": "Solved by #4 last commit",
          "createdAt": "2025-06-23T21:12:05Z",
          "updatedAt": "2025-06-23T21:12:05Z"
        }
      ]
    },
    {
      "number": 3,
      "id": "I_kwDOOIDCrM64TIoX",
      "title": "Adding reference to RFC 9470 OAuth 2.0 Step Up Authentication Challenge Protocol",
      "url": "https://github.com/identitymonk/draft-lombardo-oauth-step-up-authz-challenge-proto/issues/3",
      "state": "OPEN",
      "author": "identitymonk",
      "authorAssociation": "OWNER",
      "assignees": [],
      "labels": [],
      "body": "Feedback from @aaronpk\n\n> Justify why a new spec and one the 403 and not a 401.\nHere we expect the token to have gone through conventional OAuth2 validation first before a decision is made on the content of the claims, including the authorization_details",
      "createdAt": "2025-05-26T20:39:21Z",
      "updatedAt": "2025-06-23T21:12:23Z",
      "closedAt": null,
      "comments": [
        {
          "author": "identitymonk",
          "authorAssociation": "OWNER",
          "body": "Solved by #4  last commit",
          "createdAt": "2025-06-23T21:12:23Z",
          "updatedAt": "2025-06-23T21:12:23Z"
        }
      ]
    },
    {
      "number": 5,
      "id": "I_kwDOOIDCrM64hTHH",
      "title": "Adding a FAPI 2.0 / RAR Use case",
      "url": "https://github.com/identitymonk/draft-lombardo-oauth-step-up-authz-challenge-proto/issues/5",
      "state": "OPEN",
      "author": "identitymonk",
      "authorAssociation": "OWNER",
      "assignees": [],
      "labels": [],
      "body": "",
      "createdAt": "2025-05-28T01:58:48Z",
      "updatedAt": "2025-06-23T21:12:41Z",
      "closedAt": null,
      "comments": [
        {
          "author": "identitymonk",
          "authorAssociation": "OWNER",
          "body": "Solved by #4 last commit",
          "createdAt": "2025-06-23T21:12:41Z",
          "updatedAt": "2025-06-23T21:12:41Z"
        }
      ]
    },
    {
      "number": 6,
      "id": "I_kwDOOIDCrM64hTNM",
      "title": "Adding a SMART on FHIR / RAR use case",
      "url": "https://github.com/identitymonk/draft-lombardo-oauth-step-up-authz-challenge-proto/issues/6",
      "state": "OPEN",
      "author": "identitymonk",
      "authorAssociation": "OWNER",
      "assignees": [],
      "labels": [],
      "body": "",
      "createdAt": "2025-05-28T01:59:04Z",
      "updatedAt": "2025-06-23T21:13:01Z",
      "closedAt": null,
      "comments": [
        {
          "author": "identitymonk",
          "authorAssociation": "OWNER",
          "body": "solved by #4 last commit",
          "createdAt": "2025-06-23T21:13:01Z",
          "updatedAt": "2025-06-23T21:13:01Z"
        }
      ]
    },
    {
      "number": 7,
      "id": "I_kwDOOIDCrM64zbrW",
      "title": "Support for `method` of type `urn:ietf:params:oauth:grant-type:token-exchange`",
      "url": "https://github.com/identitymonk/draft-lombardo-oauth-step-up-authz-challenge-proto/issues/7",
      "state": "OPEN",
      "author": "identitymonk",
      "authorAssociation": "OWNER",
      "assignees": [],
      "labels": [],
      "body": "As partially discussed in #2 and as part of all the discussions on Agent as actor in the process of asking a step-up of the authorization, we could add from the beginning the support of the OAuth2 Token Exchange flow.\n\nThis could ease the path for https://datatracker.ietf.org/doc/draft-oauth-ai-agents-on-behalf-of-user/",
      "createdAt": "2025-05-29T14:13:47Z",
      "updatedAt": "2025-05-29T14:13:47Z",
      "closedAt": null,
      "comments": []
    },
    {
      "number": 8,
      "id": "I_kwDOOIDCrM679-mp",
      "title": "Refinement of 401 and 403 responses",
      "url": "https://github.com/identitymonk/draft-lombardo-oauth-step-up-authz-challenge-proto/issues/8",
      "state": "OPEN",
      "author": "yaron-zehavi",
      "authorAssociation": "NONE",
      "assignees": [],
      "labels": [],
      "body": "Instructive\n=======\n\nHTTP/1.1 401 Unauthorized\nWWW-Authenticate: error=\"new_authorization_needed\",\nauthorization_details=[{\"type\":...,...},...],\nscope=\"...\"\n\nDiscussion:\n\n- Response can use WWW-Authenticate header as in step-up-authentication draft\n- acr_values and max_age already covered by https://www.ietf.org/archive/id/draft-bertocci-oauth-step-up-authn-challenge-00.html#name-authentication-requirements but can be combined together in one response following current draft\n- authorization_details are rather verbose, but will work as header size in not limited\n- Client extensions are resulting token claims, not request parameters (no ccr_values req parm like acr_values). so belong to the informative error response\n\nInformative\n========\n\nHTTP/1.1 403 Forbidden\n\n**Missing access token claims - email**\n```json\n{\n    \"decision\": false,\n    \"context\": {\n        \"error_msg\": \"Missing token claims - email\",\n        \"details\": {\n            [{\n                    \"loc\": \"/email\",\n                    \"method\": \"exists\"\n\t\t\t}]\n        }\n    }\n}\n```\n\n**Missing access token claims - gty, ccr, cmr**\n```json\n{\n    \"decision\": false,\n    \"context\": {\n        \"error_msg\": \"Missing token claims - gty, ccr, cmr\",\n        \"details\": {\n            [{\n                    \"loc\": \"/gty\",\n                    \"method\": \"exists\"\n\t\t\t},\n\t\t\t{\n                    \"loc\": \"/ccr\",\n                    \"method\": \"exists\"\n\t\t\t},\n\t\t\t{\n                    \"loc\": \"/cmr\",\n                    \"method\": \"exists\"\n\t\t\t}]\n        }\n    }\n}\n```\n\n**Expected claim values not met - gty, ccr, cmr**\n```json\n{\n    \"decision\": false,\n    \"context\": {\n        \"error_msg\": \"Insufficient token claim value - gty, ccr, cmr\",\n        \"details\": {\n            [{\n                    \"loc\": \"/gty\",\n                    \"method\": \"simple\",\n\t\t\t\t\t\"values\": [\"authorization_code_flow\", \"client_credentials\"]\n\t\t\t},\n\t\t\t{\n                    \"loc\": \"/ccr\",\n                    \"method\": \"simple\",\n\t\t\t\t\t\"value\": \"urn:org:iana:client:assurance:level_1\"\n\t\t\t},\n\t\t\t{\n                    \"loc\": \"/cmr\",\n                    \"method\": \"simple\",\n\t\t\t\t\t\"values\": [\"private_key_jwt\", \"client_secret_jwt\"]\n\t\t\t}]\n        }\n    }\n}\n```\n\nDiscussion:\n- JSON response body as it's not a WWW-Authenticate instruction\n- Propose to employ ASC syntax to express required claims and values: https://openid.bitbucket.io/ekyc/openid-connect-advanced-syntax-for-claims.html#name-example\n- If confidentiality considerations prevent sharing detailed data then details block is redacted or omitted\n",
      "createdAt": "2025-06-17T13:48:10Z",
      "updatedAt": "2025-06-23T13:51:14Z",
      "closedAt": null,
      "comments": [
        {
          "author": "identitymonk",
          "authorAssociation": "OWNER",
          "body": "The EKYC seems like a fair proposal, will add that to the dicussion points in IETF-123 Madrid\n\nIn the meantime, adding [ Draft-OAuth2.1 / Section5.3.2 ](https://datatracker.ietf.org/doc/html/draft-ietf-oauth-v2-1-12#section-5.3.2) has reference for :\n- `403` being a valid HTTP Error Code for  Instructive response too\n- `403` supporting `WWW-Authenticate` HTTP header",
          "createdAt": "2025-06-23T13:51:14Z",
          "updatedAt": "2025-06-23T13:51:14Z"
        }
      ]
    },
    {
      "number": 9,
      "id": "I_kwDOOIDCrM682AOT",
      "title": "Dicuss ability for RP to return a reference to Request Object as defined in section 2.2 of JWT-Secured Authorization Request [RFC9101]",
      "url": "https://github.com/identitymonk/draft-lombardo-oauth-step-up-authz-challenge-proto/issues/9",
      "state": "OPEN",
      "author": "identitymonk",
      "authorAssociation": "OWNER",
      "assignees": [],
      "labels": [],
      "body": "While it is possible for the RP to return a Request Object as defined in section 2.2 of JWT-Secured Authorization Request [RFC9101] signed by the RP for the client to send to the AS, as of now there is no standard for an RP to push a JAR to the AS using Pushed Authorization Request and pass the reference URI to the client.\n\nThe group need to discuss more this proposition.\n",
      "createdAt": "2025-06-23T13:46:02Z",
      "updatedAt": "2025-06-23T18:05:45Z",
      "closedAt": null,
      "comments": [
        {
          "author": "yaron-zehavi",
          "authorAssociation": "NONE",
          "body": "I'm a bit confused, RP == client right? So maybe you meant RS where RP appears?",
          "createdAt": "2025-06-23T17:44:01Z",
          "updatedAt": "2025-06-23T17:44:01Z"
        },
        {
          "author": "identitymonk",
          "authorAssociation": "OWNER",
          "body": "RP === Resource Provider === Resource Server and not the Client",
          "createdAt": "2025-06-23T17:59:55Z",
          "updatedAt": "2025-06-23T17:59:55Z"
        },
        {
          "author": "yaron-zehavi",
          "authorAssociation": "NONE",
          "body": "I see, RP is also an OpenID term for Relying Party, which confused me",
          "createdAt": "2025-06-23T18:05:45Z",
          "updatedAt": "2025-06-23T18:05:45Z"
        }
      ]
    }
  ],
  "pulls": [
    {
      "number": 1,
      "id": "PR_kwDOOIDCrM6XelOZ",
      "title": "Draft 00",
      "url": "https://github.com/identitymonk/draft-lombardo-oauth-step-up-authz-challenge-proto/pull/1",
      "state": "MERGED",
      "author": "identitymonk",
      "authorAssociation": "OWNER",
      "assignees": [],
      "labels": [],
      "body": "Inital push to declare the base of the proposal",
      "createdAt": "2025-05-24T04:45:53Z",
      "updatedAt": "2025-06-23T21:20:03Z",
      "baseRepository": "identitymonk/draft-lombardo-oauth-step-up-authz-challenge-proto",
      "baseRefName": "main",
      "baseRefOid": "d2edb746d099ac8b11f519825f25338957dead6d",
      "headRepository": "identitymonk/draft-lombardo-oauth-step-up-authz-challenge-proto",
      "headRefName": "Draft-00",
      "headRefOid": "1ce6776cb840d7c5b738e6966ec2d2ad11356cda",
      "closedAt": "2025-05-24T04:46:32Z",
      "mergedAt": "2025-05-24T04:46:32Z",
      "mergedBy": "identitymonk",
      "mergeCommit": {
        "oid": "b04b2590c809514dc1f132d56884c3409abfc474"
      },
      "comments": [],
      "reviews": []
    },
    {
      "number": 4,
      "id": "PR_kwDOOIDCrM6X3yVb",
      "title": "Alex's updates",
      "url": "https://github.com/identitymonk/draft-lombardo-oauth-step-up-authz-challenge-proto/pull/4",
      "state": "MERGED",
      "author": "baboulebou",
      "authorAssociation": "COLLABORATOR",
      "assignees": [],
      "labels": [],
      "body": "- Fixes to various part of the text, clarifications.\r\n- Changed the LLM example to use MCP.",
      "createdAt": "2025-05-28T00:32:27Z",
      "updatedAt": "2025-06-23T21:19:36Z",
      "baseRepository": "identitymonk/draft-lombardo-oauth-step-up-authz-challenge-proto",
      "baseRefName": "main",
      "baseRefOid": "ae377152869f17b239569131a100af09c9a3a863",
      "headRepository": "identitymonk/draft-lombardo-oauth-step-up-authz-challenge-proto",
      "headRefName": "alex-review-1",
      "headRefOid": "6e703220314c5d441a2de12db182fac51aa51a91",
      "closedAt": "2025-06-23T21:19:30Z",
      "mergedAt": "2025-06-23T21:19:30Z",
      "mergedBy": "identitymonk",
      "mergeCommit": {
        "oid": "7dd4ca3cafbf1072619fc73a2e4d635fc363a585"
      },
      "comments": [
        {
          "author": "identitymonk",
          "authorAssociation": "OWNER",
          "body": " Update following team call:\r\n\r\n- Updated Authors list\r\n- Created acknowledgement\r\n- Added reference to RFC9470\r\n- Added references and examples for FAPI 2.0 Security Profiles as long SMART on FHIR\r\n- Corrected AuthZEN payload in response\r\n- Changed Applicative Error Code based on decisions (did not not change 403 for 401)\r\n- Changed Applicative Error description\r\n- Modified JAR parameter and removed Request parameter\r\n- Removed AS metadata requirements\r\n- Reworked Security Section",
          "createdAt": "2025-06-23T21:19:15Z",
          "updatedAt": "2025-06-23T21:19:15Z"
        }
      ],
      "reviews": [
        {
          "id": "PRR_kwDOOIDCrM6rW8bo",
          "commit": {
            "abbreviatedOid": "fe13187"
          },
          "author": "identitymonk",
          "authorAssociation": "OWNER",
          "state": "COMMENTED",
          "body": "First path review",
          "createdAt": "2025-05-28T12:55:34Z",
          "updatedAt": "2025-05-28T13:22:56Z",
          "comments": [
            {
              "originalPosition": 5,
              "body": "We need to check why this is a change",
              "createdAt": "2025-05-28T12:55:34Z",
              "updatedAt": "2025-05-28T13:22:56Z"
            },
            {
              "originalPosition": 30,
              "body": "I ponder if we should not rename `insufficient_delegated_authorization` as `insufficient_authorization` to simplify as the other error code",
              "createdAt": "2025-05-28T12:58:13Z",
              "updatedAt": "2025-05-28T13:22:56Z"
            },
            {
              "originalPosition": 55,
              "body": "oxford comma",
              "createdAt": "2025-05-28T12:59:43Z",
              "updatedAt": "2025-05-28T13:22:56Z"
            },
            {
              "originalPosition": 64,
              "body": "- `the methods by which`\r\n- We might need to rework the sentence `this document rather describes the methoids by which the resource provider can signal to the client the type(s) of authorization garantees it is expected to obtain from the authorization server for the given request.`",
              "createdAt": "2025-05-28T13:02:48Z",
              "updatedAt": "2025-05-28T13:22:56Z"
            },
            {
              "originalPosition": 76,
              "body": "The Request does not have an internal authorization state requirements. It is fixed by the RP with the help of a PDP (optionally) so it is really `the` and not `its`",
              "createdAt": "2025-05-28T13:09:04Z",
              "updatedAt": "2025-05-28T13:22:56Z"
            },
            {
              "originalPosition": 85,
              "body": "We should have a complete see section X - below is too vague in guidance",
              "createdAt": "2025-05-28T13:10:03Z",
              "updatedAt": "2025-05-28T13:22:56Z"
            },
            {
              "originalPosition": 83,
              "body": "see comment on simplify this error code",
              "createdAt": "2025-05-28T13:10:25Z",
              "updatedAt": "2025-05-28T13:22:56Z"
            },
            {
              "originalPosition": 90,
              "body": "Should we not replace the `SHOULD` here with a `SHALL`",
              "createdAt": "2025-05-28T13:11:07Z",
              "updatedAt": "2025-05-28T13:22:56Z"
            },
            {
              "originalPosition": 109,
              "body": "As we removed the diagram with `<payload>` we can switch to the formal `HTTP body payload` mention here",
              "createdAt": "2025-05-28T13:16:15Z",
              "updatedAt": "2025-05-28T13:22:56Z"
            },
            {
              "originalPosition": 118,
              "body": "We need to do a pass on all MUST / SHOULD and other RFC keywords for the usage for of uppercase representation",
              "createdAt": "2025-05-28T13:17:10Z",
              "updatedAt": "2025-05-28T13:22:57Z"
            },
            {
              "originalPosition": 129,
              "body": "As we have the AuthZEN example after this one, maybe we can remove this one",
              "createdAt": "2025-05-28T13:18:25Z",
              "updatedAt": "2025-05-28T13:22:57Z"
            },
            {
              "originalPosition": 170,
              "body": "We should ensure this message for this error code is also AuthZEN formatted",
              "createdAt": "2025-05-28T13:19:24Z",
              "updatedAt": "2025-05-28T13:22:57Z"
            },
            {
              "originalPosition": 394,
              "body": "While markdown resolves the numbering properly, it might not be the case of other RFC format - we need to solve that here",
              "createdAt": "2025-05-28T13:22:30Z",
              "updatedAt": "2025-05-28T13:22:57Z"
            }
          ]
        },
        {
          "id": "PRR_kwDOOIDCrM6rYW66",
          "commit": {
            "abbreviatedOid": "fe13187"
          },
          "author": "baboulebou",
          "authorAssociation": "COLLABORATOR",
          "state": "COMMENTED",
          "body": "",
          "createdAt": "2025-05-28T14:14:14Z",
          "updatedAt": "2025-05-28T14:14:14Z",
          "comments": [
            {
              "originalPosition": 30,
              "body": "I agree !",
              "createdAt": "2025-05-28T14:14:14Z",
              "updatedAt": "2025-05-28T14:14:14Z"
            }
          ]
        },
        {
          "id": "PRR_kwDOOIDCrM6rYbh4",
          "commit": {
            "abbreviatedOid": "fe13187"
          },
          "author": "baboulebou",
          "authorAssociation": "COLLABORATOR",
          "state": "COMMENTED",
          "body": "",
          "createdAt": "2025-05-28T14:19:29Z",
          "updatedAt": "2025-05-28T14:19:29Z",
          "comments": [
            {
              "originalPosition": 64,
              "body": "Done, check for new commit.",
              "createdAt": "2025-05-28T14:19:29Z",
              "updatedAt": "2025-05-28T14:19:29Z"
            }
          ]
        },
        {
          "id": "PRR_kwDOOIDCrM6rYdx-",
          "commit": {
            "abbreviatedOid": "fe13187"
          },
          "author": "baboulebou",
          "authorAssociation": "COLLABORATOR",
          "state": "COMMENTED",
          "body": "",
          "createdAt": "2025-05-28T14:22:04Z",
          "updatedAt": "2025-05-28T14:22:05Z",
          "comments": [
            {
              "originalPosition": 76,
              "body": "\"its\" refers to the \"Resource Server\" coming right after the \",\". I reworked the sentence, should be clearer now.\r\n",
              "createdAt": "2025-05-28T14:22:05Z",
              "updatedAt": "2025-05-28T14:22:05Z"
            }
          ]
        },
        {
          "id": "PRR_kwDOOIDCrM6rYi_B",
          "commit": {
            "abbreviatedOid": "fe13187"
          },
          "author": "baboulebou",
          "authorAssociation": "COLLABORATOR",
          "state": "COMMENTED",
          "body": "",
          "createdAt": "2025-05-28T14:28:14Z",
          "updatedAt": "2025-05-28T14:28:15Z",
          "comments": [
            {
              "originalPosition": 109,
              "body": "Done.",
              "createdAt": "2025-05-28T14:28:14Z",
              "updatedAt": "2025-05-28T14:28:15Z"
            }
          ]
        },
        {
          "id": "PRR_kwDOOIDCrM6rYj2w",
          "commit": {
            "abbreviatedOid": "fe13187"
          },
          "author": "baboulebou",
          "authorAssociation": "COLLABORATOR",
          "state": "COMMENTED",
          "body": "",
          "createdAt": "2025-05-28T14:29:16Z",
          "updatedAt": "2025-05-28T14:29:16Z",
          "comments": [
            {
              "originalPosition": 118,
              "body": "done",
              "createdAt": "2025-05-28T14:29:16Z",
              "updatedAt": "2025-05-28T14:29:16Z"
            }
          ]
        },
        {
          "id": "PRR_kwDOOIDCrM6rY1ua",
          "commit": {
            "abbreviatedOid": "fe13187"
          },
          "author": "baboulebou",
          "authorAssociation": "COLLABORATOR",
          "state": "COMMENTED",
          "body": "",
          "createdAt": "2025-05-28T14:50:28Z",
          "updatedAt": "2025-05-28T14:50:29Z",
          "comments": [
            {
              "originalPosition": 129,
              "body": "Well I think it helps clarify things, may be redundant but not quite. It should an actual AuthZEN response (from the authzen spec), wanted to show an actual example.",
              "createdAt": "2025-05-28T14:50:29Z",
              "updatedAt": "2025-05-28T14:50:29Z"
            }
          ]
        },
        {
          "id": "PRR_kwDOOIDCrM6rY7Zp",
          "commit": {
            "abbreviatedOid": "fe13187"
          },
          "author": "baboulebou",
          "authorAssociation": "COLLABORATOR",
          "state": "COMMENTED",
          "body": "",
          "createdAt": "2025-05-28T14:56:57Z",
          "updatedAt": "2025-05-28T14:56:57Z",
          "comments": [
            {
              "originalPosition": 170,
              "body": "done",
              "createdAt": "2025-05-28T14:56:57Z",
              "updatedAt": "2025-05-28T14:56:57Z"
            }
          ]
        }
      ]
    }
  ]
}